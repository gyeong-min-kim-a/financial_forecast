# financial_forecast
재정전망 예측 프로젝트
1. 개요
- 기간 : 2023.09~2024.02
- 목표 
	- 미국이나 영국과 달리 한국은 독자적인 재정전망 방법이 존재하지 않음. 경제성장률, 총지출의 증감을 통해 예산을 책정 혹은 배정하였음. 따라서 재량지출 성격에 따라 세분화하여 재량지출에 대한 객관적이고 타당한 추계를 위한 방법론 개발이 필요함.
	- 본 연구에서는 정부의 예산 편성 분야에 인공지능의 적용 가능성을 알아보고자함.
- 간단한 연구 설명
	- 과거 복잡한 사회 변수를 모두 넣기 어려워 일부 변수를 사용하는 전통적인 통계를 기반으로 예산을 편성하나, 최근 머신러닝 미 딥러닝을 활용하는 연구가 진행되면고 있음. 정부 예산이 편성되는 분야 중 4개(과학기술, 식품안전, 고등교육, 기후대기)에 대해서 향후 년도의 예산을 예측하고자 함.
	- 통계적 방법/머신러닝/딥러닝을 각 분야에 접목하여 예산을 예측하고, 결과를 바탕으로 각 방법론의 가능성을 탐색함.
	- 2009 ~ 2020년까지 데이터를 활용하여 21 ~ 23년의 예산을 예측
- 역할
	- 머신러닝 분석을 담당함. 
	- 머신러닝의 경우 Linear Regression, Lasso, Ridge, GradientBoosting, RandomForest를 사용함.
		- Linear Regression, Lasso, Ridge의 경우 변수 선택의 효과를 감안하여 사용함
		- GradientBoosting, RandomForest는 각각 부스팅과 배깅의 방식으로, 각 방법론의 대표적인 기법이므로 사용함.
		
2. 데이터세트
	- 예산변수는 열린재정을 통해 수집하였으며, 과학기술 분야 예산에 영향을 미치는 과학기술 변수는 국가과학기술지식정보서비스(NTIS)의 과학기술 통계, KOSIS 등을 활용하여 전체 변수를 확정하였음.
	- 종속변수는 2007년부터 2023년까지, 독립변수는 2009년부터 2023년까지 데이터를 구축하였으며 분석에 사용된 변수는 예산편성과정의 특수성을 고려하여 독립변수와 종속변수의 시간관계를 설정하였음(2년 간격)
		- 아래의 그림과 같이 종속변수와 독립변수의 년도 설정이 다름
	- ![Pasted image 20240629211650](https://github.com/gyeong-min-kim-a/financial_forecast/assets/174190109/d0f30a56-0de0-4cfc-a68a-1f743ab7d305)
	- 각 분야별로 4개의 데이트 세트 존재
		- 모든 독립변수(독립변수 30~60개)포함 데이터세트(400여개의 변수를 확보하고 전체 시계열에 대한 자료 존재 유무를 검토하여 결측치가 많고 대표성이 약한 변수를 제외하고 최종 64개의 변수를 선정)
		- 연구자선정(독립변수 10개 내외) 데이터세트(회귀모델의 가용성, 유의확률, 공선성을 고려하여 과학기술 예산에 유효한 변수를 선정)
		- 상관관계를 기준으로 상위 5개만을 독립변수로 하는 데이터세트
		- 상관관계를 기준으로 상위 10개만을 독립변수로 하는 데이터세트
			- Pearson 상관계수를 활용하되, 기계적 변수선정을 차단하기 위해 동일범주의 변수에 대해서는 가장 높은 상관관계 값의 변수만 사용
			
3. 머신러닝 방법 적용(버전마다 사용한 데이터세트가 다름)
	1. 버전1(최종 데이터세트 적용 코드)
		- 정규화 적용(단위 다양 + 숫자 범위 다양)
			- 첫번째 열 : 년도, 두번째 열 : 종속변수이므로 이 두개의 열을 제외하고 독립변수만 정규화 적용(종속변수에 대해서 적용할 필요 x)
		- 최대한 많은 정보를 활용하기 위해 window_size(=2) 적용
			- 시계열의 특성 상 전후 시간의 영향을 받는 것 
			- 예산 편성의 경우 목표 년도의 2년 전 사회적 상황을 기준으로 책정함
			- 행이 15개로 매우 적지만 열은 5개에서 약 60개까지 있을 수 있음
		- Linear Regression, Lasso, Ridge, GradientBoosting, RandomForest방법마다 그리드서치를 통해 최적의 파라미터로 예측
			- 기준은 -mse를 사용
		- 목표년도의 종속변수인 총예산을 예측하기 위해서 2년 전, 3년 전 데이터를 사용
			- ex) 2021년도를 예측하기 위해 2018, 2019년도 데이터 사용.
			- 버전1 예시 그림![Pasted image 20240630170637](https://github.com/gyeong-min-kim-a/financial_forecast/assets/174190109/5adc4dff-f8d8-4911-af74-2a6d33934d85)

	2. 버전2(순차학습 시 사용 코드, 2033년까지 장기추계할때 사용)
		- 정규화적용
		- 최대한 많은 정보를 활용하기 위해 window_size(=2) 적용
			- 이유는 위와 동일함
			- Linear Regression, Lasso, Ridge, GradientBoosting, RandomForest방법마다 그리드서치를 통해 최적의 파라미터로 예측
			- 기준은 -mse를 사용
		- 목표년도의 종속변수를 사용하기 위해 2년, 3년 전 데이터를 사용하는 것은 동일하나, 학습을 반복적으로 진행함.
			- 구체적으로 예를 들면, 2021년도의 종속변수를 예측하기 위해서 2019년도까지의 데이터세트를 활용하였고, 2022년도의 종속변수 예측을 할 때에는 2020까지의 데이터를 활용함.
			- 버전2 예시 그림![Pasted image 20240629222247](https://github.com/gyeong-min-kim-a/financial_forecast/assets/174190109/379bd403-e2f2-4e09-98ed-f910aba02273)

	3. 버전3(버전 2와 같이 2033년까지 장기추계할때 사용하였으나, 2020년까지만 학습에 이용하고 2021~2033년을 예측, 일반적인 예측 형태)
		- 정규화 적용
		- window_sizw(=2)적용
		- train(2009~2020), test(2021~2033)로 분할하여 예측함
		- 버전3 예시 그림![Pasted image 20240630170336](https://github.com/gyeong-min-kim-a/financial_forecast/assets/174190109/08daa528-8429-4d49-bea4-a0e7d14060cc)

4. 연구 결과(머신러닝 위주)
	- 버전1에 대한 예측 결과
		- 시계열의 추세가 안정적으로 변하는 과학기술의 예측성능이 가장 우수함.
			- 재량지출은 전체 예산 편성에 50%를 담당하지만, 정치, 경제, 사회, 환경변화 등을 고려하여 정책적 의지를 반영하여 편성됨. 때문에 해마다 편성되는 금액이 크게 차이날 수 있음. 
			- Lasso, Ridge 등을 사용한 경우에는 오차율이 0.43일 때도 있었으며, 전체 변수에 대한 적용의 경우 2%미만의 오차율을 보여 가능성을 볼 수 있었음.
		- 변화의 폭이 컸던 기후대기의 데이터세트의 경우, 예측 성능이 매우 저조하였음.
			- 훈련에 쓰인 데이터의 경우 예산이 감소하는 추세를 보였고, 테스트에 쓰인 데이터는 증가하는 추세를 보이기 때문으로 보임.
		- Ridge, Lasso에 의한 변수 제거의 효과는 보지 못함
			- 사람이 생각했을 때 중요해보이는 변수와 실제로 Lasso의 변수 선택 결과 납득하기 어려운 변수가 도출되어, 독립변수의 해석이 중요한 이번 연구에서는 사용하지 않기고 함.
		- RandomForest, GradientBoosting 모두 시계열으 추세를 반영하여 장기추계에 사용하기는 어려웠음
			- 데이터 추세의 일관성 문제도 존재하긴 하지만, 트리 기반의 모델은 데이터를 분할하며 예측하기 때문에, 선형이 아닌 비선형적인 구조에 대해서 예측할 때 유리하다고 생각함
			- 하나의 트리에서 지속적인 증가 추세를 모델링하기도 어렵다고 생각함
			- 추세가 아닌 0~1사이에 숫자로 이루어진 출산률과 같은 변수가 트리의 분할 변수로 선택되는 경우에도 시간적인 특징을 반영하기 어려울 수 있음.
